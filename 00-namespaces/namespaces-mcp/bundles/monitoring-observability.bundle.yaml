version: "2.0.0"
semantic_role: deployment_bundle
artifact_type: bundle
semantic_root: false
module: monitoring-observability

description: |
  Complete deployment bundle for the Monitoring & Observability module.
  Includes all source files, dependencies, configuration, and deployment
  strategies for metrics, logging, tracing, and dashboard components.

# ============================================================================
# COMPONENT INVENTORY
# ============================================================================

components:
  # Layer 1: Metrics Collection (4 files)
  metrics:
    - path: "src/monitoring/metrics/metrics-collector.ts"
      type: "implementation"
      size: "22.9 KB"
      lines: 650
      exports: ["MetricsCollector", "IMetricsCollector"]
      
    - path: "src/monitoring/metrics/performance-monitor.ts"
      type: "implementation"
      size: "18.5 KB"
      lines: 520
      exports: ["PerformanceMonitor", "IPerformanceMonitor"]
      
    - path: "src/monitoring/metrics/health-checker.ts"
      type: "implementation"
      size: "15.2 KB"
      lines: 430
      exports: ["HealthChecker", "IHealthChecker"]
      
    - path: "src/monitoring/metrics/alert-manager.ts"
      type: "implementation"
      size: "19.8 KB"
      lines: 560
      exports: ["AlertManager", "IAlertManager"]
      
  # Layer 2: Logging System (4 files)
  logging:
    - path: "src/monitoring/logging/logger.ts"
      type: "implementation"
      size: "16.3 KB"
      lines: 460
      exports: ["Logger", "ILogger"]
      
    - path: "src/monitoring/logging/log-aggregator.ts"
      type: "implementation"
      size: "20.1 KB"
      lines: 570
      exports: ["LogAggregator", "ILogAggregator"]
      
    - path: "src/monitoring/logging/log-analyzer.ts"
      type: "implementation"
      size: "17.9 KB"
      lines: 510
      exports: ["LogAnalyzer", "ILogAnalyzer"]
      
    - path: "src/monitoring/logging/audit-logger.ts"
      type: "implementation"
      size: "14.7 KB"
      lines: 420
      exports: ["AuditLogger", "IAuditLogger"]
      
  # Layer 3: Distributed Tracing (4 files)
  tracing:
    - path: "src/monitoring/tracing/trace-manager.ts"
      type: "implementation"
      size: "21.4 KB"
      lines: 610
      exports: ["TraceManager", "ITraceManager"]
      
    - path: "src/monitoring/tracing/span-collector.ts"
      type: "implementation"
      size: "18.6 KB"
      lines: 530
      exports: ["SpanCollector", "ISpanCollector"]
      
    - path: "src/monitoring/tracing/trace-analyzer.ts"
      type: "implementation"
      size: "19.2 KB"
      lines: 550
      exports: ["TraceAnalyzer", "ITraceAnalyzer"]
      
    - path: "src/monitoring/tracing/performance-profiler.ts"
      type: "implementation"
      size: "16.8 KB"
      lines: 480
      exports: ["PerformanceProfiler", "IPerformanceProfiler"]
      
  # Layer 4: Dashboard & Visualization (4 files)
  dashboard:
    - path: "src/monitoring/dashboard/dashboard-server.ts"
      type: "implementation"
      size: "23.5 KB"
      lines: 670
      exports: ["DashboardServer", "IDashboardServer"]
      
    - path: "src/monitoring/dashboard/metrics-api.ts"
      type: "implementation"
      size: "20.7 KB"
      lines: 590
      exports: ["MetricsAPI", "IMetricsAPI"]
      
    - path: "src/monitoring/dashboard/visualization.ts"
      type: "implementation"
      size: "17.3 KB"
      lines: 490
      exports: ["Visualization", "IVisualization"]
      
    - path: "src/monitoring/dashboard/report-generator.ts"
      type: "implementation"
      size: "19.1 KB"
      lines: 540
      exports: ["ReportGenerator", "IReportGenerator"]
      
  # Legacy/Consolidated Files (3 files)
  legacy:
    - path: "src/monitoring/metrics-collector.ts"
      type: "implementation"
      size: "22.9 KB"
      lines: 650
      exports: ["MetricsCollector"]
      
    - path: "src/monitoring/logging-system.ts"
      type: "implementation"
      size: "27.3 KB"
      lines: 780
      exports: ["LoggingSystem"]
      
    - path: "src/monitoring/distributed-tracing.ts"
      type: "implementation"
      size: "26.4 KB"
      lines: 750
      exports: ["DistributedTracing"]
      
    - path: "src/monitoring/health-monitoring.ts"
      type: "implementation"
      size: "31.5 KB"
      lines: 900
      exports: ["HealthMonitoring"]
      
  # Index & Exports
  index:
    - path: "src/monitoring/index.ts"
      type: "barrel"
      size: "8.4 KB"
      lines: 240
      exports: ["*"]

# ============================================================================
# DEPENDENCIES
# ============================================================================

dependencies:
  internal:
    - module: "@mcp/protocol"
      version: "^2.0.0"
      components: ["Request", "Response", "ErrorHandler"]
      
    - module: "@mcp/data-management"
      version: "^2.0.0"
      components: ["StorageInterface", "CacheManager"]
      
  external:
    runtime:
      - name: "prometheus-client"
        version: "^14.2.0"
        purpose: "Metrics collection and export"
        
      - name: "winston"
        version: "^3.11.0"
        purpose: "Structured logging"
        
      - name: "@opentelemetry/api"
        version: "^1.9.0"
        purpose: "Distributed tracing API"
        
      - name: "@opentelemetry/sdk-trace-node"
        version: "^1.9.0"
        purpose: "Tracing SDK"
        
      - name: "express"
        version: "^4.18.0"
        purpose: "Dashboard HTTP server"
        
      - name: "ws"
        version: "^8.16.0"
        purpose: "WebSocket for real-time updates"
        
    development:
      - name: "@types/node"
        version: "^20.0.0"
        
      - name: "@types/express"
        version: "^4.17.0"
        
      - name: "@types/ws"
        version: "^8.5.0"

# ============================================================================
# DEPLOYMENT CONFIGURATION
# ============================================================================

deployment:
  strategy:
    type: "rolling"
    max_surge: 1
    max_unavailable: 0
    
  replicas:
    min: 2
    max: 10
    target_cpu: 70
    target_memory: 80
    
  resources:
    requests:
      cpu: "500m"
      memory: "1Gi"
    limits:
      cpu: "2000m"
      memory: "4Gi"
      
  health_checks:
    liveness:
      path: "/health/live"
      interval: 10
      timeout: 5
      failure_threshold: 3
      
    readiness:
      path: "/health/ready"
      interval: 5
      timeout: 3
      failure_threshold: 2
      
  environment:
    - name: "NODE_ENV"
      value: "production"
      
    - name: "LOG_LEVEL"
      value: "info"
      
    - name: "METRICS_PORT"
      value: "9090"
      
    - name: "TRACING_ENABLED"
      value: "true"
      
    - name: "TRACING_SAMPLE_RATE"
      value: "0.1"

# ============================================================================
# VALIDATION
# ============================================================================

validation:
  pre_deployment:
    - name: "type_check"
      command: "tsc --noEmit"
      required: true
      
    - name: "lint"
      command: "eslint src/monitoring/**/*.ts"
      required: true
      
    - name: "unit_tests"
      command: "jest src/monitoring"
      required: true
      coverage_threshold: 90
      
    - name: "integration_tests"
      command: "jest --testPathPattern=integration"
      required: true
      
  post_deployment:
    - name: "health_check"
      endpoint: "/health"
      expected_status: 200
      timeout: 30
      
    - name: "metrics_endpoint"
      endpoint: "/metrics"
      expected_status: 200
      timeout: 10
      
    - name: "smoke_tests"
      command: "npm run test:smoke"
      required: true

# ============================================================================
# ROLLBACK CONFIGURATION
# ============================================================================

rollback:
  automatic:
    enabled: true
    conditions:
      - "health_check_failure > 3"
      - "error_rate > 5%"
      - "response_time_p99 > 2s"
      
  manual:
    retention: 5  # Keep last 5 versions
    
  strategy:
    type: "instant"
    verification_time: 60  # seconds

# ============================================================================
# MONITORING & OBSERVABILITY
# ============================================================================

monitoring:
  metrics:
    - name: "monitoring_requests_total"
      type: "counter"
      labels: ["method", "endpoint", "status"]
      
    - name: "monitoring_request_duration_seconds"
      type: "histogram"
      labels: ["method", "endpoint"]
      buckets: [0.01, 0.05, 0.1, 0.5, 1, 5]
      
    - name: "monitoring_active_connections"
      type: "gauge"
      labels: ["type"]
      
    - name: "monitoring_data_ingestion_rate"
      type: "gauge"
      labels: ["type"]
      
  alerts:
    - name: "HighErrorRate"
      condition: "error_rate > 5%"
      duration: "5m"
      severity: "critical"
      
    - name: "HighLatency"
      condition: "p99_latency > 1s"
      duration: "10m"
      severity: "warning"
      
    - name: "LowAvailability"
      condition: "availability < 99.9%"
      duration: "5m"
      severity: "critical"

# ============================================================================
# CONFIGURATION
# ============================================================================

configuration:
  files:
    - path: "config/monitoring.yaml"
      type: "yaml"
      required: true
      
    - path: "config/alerts.yaml"
      type: "yaml"
      required: false
      
    - path: "config/dashboards.json"
      type: "json"
      required: false
      
  secrets:
    - name: "prometheus-credentials"
      keys: ["username", "password"]
      
    - name: "grafana-api-key"
      keys: ["api_key"]
      
    - name: "alertmanager-webhook"
      keys: ["webhook_url"]

# ============================================================================
# METADATA
# ============================================================================

metadata:
  created_at: "2025-01-10T14:00:00Z"
  updated_at: "2025-01-11T09:00:00Z"
  version: "2.0.0"
  status: "active"
  total_components: 21
  total_size: "420 KB"
  total_lines: 11950
  layers: 4
  maintainer: "MachineNativeOps Team"
  
build_info:
  build_time: "< 2 minutes"
  bundle_size: "~2 MB (minified)"
  dependencies_size: "~50 MB"