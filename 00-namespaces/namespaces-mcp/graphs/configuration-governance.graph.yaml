version: "2.0.0"
semantic_role: dependency_graph
artifact_type: graph
semantic_root: false
module: configuration-governance

description: |
  Complete dependency graph for the Configuration & Governance module.
  Visualizes relationships between policy engine, compliance, access control,
  configuration management, and deployment governance with 10 nodes across 5 layers.

# ============================================================================
# GRAPH STRUCTURE
# ============================================================================

graph:
  type: "DAG"  # Directed Acyclic Graph
  direction: "top-down"
  layers: 5
  
nodes:
  # ============================================================================
  # LAYER 1: POLICY ENGINE (2 nodes)
  # ============================================================================
  
  policy_engine:
    id: "governance.policy.engine"
    type: "service"
    layer: 1
    component: "PolicyEngine"
    file: "src/governance/policy/policy-engine.ts"
    responsibilities:
      - "Create and manage policies"
      - "Evaluate policy rules"
      - "Cache policy decisions"
      - "Version control for policies"
    interfaces:
      provides: ["IPolicyEngine", "IPolicyValidator"]
      consumes: ["IStorage", "ICache"]
    performance:
      evaluation_p99: "< 20ms"
      cache_hit_rate: "> 80%"
      throughput: "> 10000 evaluations/sec"
      
  policy_engine_config:
    id: "configuration.policy.engine"
    type: "service"
    layer: 1
    component: "PolicyEngine (Config)"
    file: "src/configuration/policy-engine.ts"
    responsibilities:
      - "Policy-based configuration"
      - "Dynamic policy updates"
      - "Policy validation"
    interfaces:
      provides: ["IPolicyEngine"]
      consumes: ["IStorage"]
    performance:
      evaluation_p99: "< 20ms"

  # ============================================================================
  # LAYER 2: COMPLIANCE & AUDIT (2 nodes)
  # ============================================================================
  
  compliance_checker:
    id: "governance.compliance.checker"
    type: "service"
    layer: 2
    component: "ComplianceChecker"
    file: "src/governance/compliance/compliance-checker.ts"
    responsibilities:
      - "Scan for compliance violations"
      - "Generate compliance reports"
      - "Track remediation status"
      - "Multi-framework support"
    interfaces:
      provides: ["IComplianceChecker"]
      consumes: ["IPolicyEngine", "IAuditManager"]
    performance:
      scan_duration_p99: "< 30s"
      accuracy: "> 95%"
      frameworks: ["SOC2", "HIPAA", "GDPR", "PCI-DSS", "ISO27001", "NIST"]
      
  audit_manager:
    id: "governance.audit.manager"
    type: "service"
    layer: 2
    component: "AuditManager"
    file: "src/governance/audit/audit-manager.ts"
    responsibilities:
      - "Log audit events"
      - "Query audit logs"
      - "Generate audit reports"
      - "Ensure immutability"
    interfaces:
      provides: ["IAuditManager"]
      consumes: ["IStorage", "ILogger"]
    performance:
      log_latency_p99: "< 20ms"
      query_latency_p99: "< 5s"
      retention: "7 years"

  # ============================================================================
  # LAYER 3: ACCESS CONTROL (1 node)
  # ============================================================================
  
  access_control:
    id: "configuration.access.control"
    type: "service"
    layer: 3
    component: "AccessControl"
    file: "src/configuration/access-control.ts"
    responsibilities:
      - "Enforce access control policies"
      - "RBAC and ABAC support"
      - "Role management"
      - "Permission checking"
    interfaces:
      provides: ["IAccessControl", "IRoleManager"]
      consumes: ["IPolicyEngine", "IAuditManager", "ICache"]
    performance:
      check_latency_p99: "< 20ms"
      cache_hit_rate: "> 90%"
      models: ["rbac", "abac", "hybrid"]

  # ============================================================================
  # LAYER 4: CONFIGURATION MANAGEMENT (1 node)
  # ============================================================================
  
  dynamic_config:
    id: "configuration.dynamic.config"
    type: "service"
    layer: 4
    component: "DynamicConfig"
    file: "src/configuration/dynamic-config.ts"
    responsibilities:
      - "Manage dynamic configurations"
      - "Configuration versioning"
      - "Feature flag management"
      - "Configuration validation"
    interfaces:
      provides: ["IConfigurationManager", "IFeatureFlagManager"]
      consumes: ["IPolicyEngine", "IAccessControl", "IStorage"]
    performance:
      retrieval_p99: "< 100ms"
      cache_hit_rate: "> 95%"
      update_propagation: "< 1s"

  # ============================================================================
  # LAYER 5: DEPLOYMENT GOVERNANCE (2 nodes)
  # ============================================================================
  
  deployment_pipeline:
    id: "governance.deployment.pipeline"
    type: "service"
    layer: 5
    component: "DeploymentPipeline"
    file: "src/governance/deployment/deployment-pipeline.ts"
    responsibilities:
      - "Manage deployment requests"
      - "Approval workflow"
      - "Deployment execution"
      - "Automatic rollback"
    interfaces:
      provides: ["IDeploymentGovernance"]
      consumes: ["IPolicyEngine", "IAccessControl", "IAuditManager"]
    performance:
      approval_time: "< 1 hour"
      execution_time: "< 10 minutes"
      rollback_time: "< 2 minutes"
      
  governance_dashboard:
    id: "governance.dashboard"
    type: "service"
    layer: 5
    component: "GovernanceDashboard"
    file: "src/governance/dashboard/governance-dashboard.ts"
    responsibilities:
      - "Visualize governance metrics"
      - "Display compliance status"
      - "Show policy violations"
      - "Track deployments"
    interfaces:
      provides: ["IGovernanceDashboard"]
      consumes: ["IComplianceChecker", "IPolicyEngine", "IDeploymentGovernance", "IMetricsCollector"]
    performance:
      query_latency_p99: "< 500ms"
      refresh_interval: "30s"

  # ============================================================================
  # INDEX NODES (2 nodes)
  # ============================================================================
  
  governance_index:
    id: "governance.index"
    type: "barrel"
    layer: 0
    component: "Governance Index"
    file: "src/governance/index.ts"
    responsibilities:
      - "Export governance components"
      - "Provide unified API"
      
  configuration_index:
    id: "configuration.index"
    type: "barrel"
    layer: 0
    component: "Configuration Index"
    file: "src/configuration/index.ts"
    responsibilities:
      - "Export configuration components"
      - "Provide unified API"

# ============================================================================
# EDGES (Dependencies)
# ============================================================================

edges:
  # Layer 2 depends on Layer 1
  - from: "governance.compliance.checker"
    to: "governance.policy.engine"
    type: "uses"
    description: "Compliance checker uses policy engine for rule evaluation"
    
  - from: "governance.compliance.checker"
    to: "governance.audit.manager"
    type: "uses"
    description: "Compliance checker logs to audit manager"
    
  # Layer 3 depends on Layer 1 and 2
  - from: "configuration.access.control"
    to: "governance.policy.engine"
    type: "uses"
    description: "Access control uses policy engine for authorization"
    
  - from: "configuration.access.control"
    to: "governance.audit.manager"
    type: "uses"
    description: "Access control logs to audit manager"
    
  # Layer 4 depends on Layer 1 and 3
  - from: "configuration.dynamic.config"
    to: "configuration.policy.engine"
    type: "uses"
    description: "Dynamic config uses policy engine for validation"
    
  - from: "configuration.dynamic.config"
    to: "configuration.access.control"
    type: "uses"
    description: "Dynamic config checks access control"
    
  # Layer 5 depends on Layer 1, 2, and 3
  - from: "governance.deployment.pipeline"
    to: "governance.policy.engine"
    type: "uses"
    description: "Deployment pipeline enforces policies"
    
  - from: "governance.deployment.pipeline"
    to: "configuration.access.control"
    type: "uses"
    description: "Deployment pipeline checks access"
    
  - from: "governance.deployment.pipeline"
    to: "governance.audit.manager"
    type: "uses"
    description: "Deployment pipeline logs to audit"
    
  - from: "governance.dashboard"
    to: "governance.compliance.checker"
    type: "uses"
    description: "Dashboard displays compliance status"
    
  - from: "governance.dashboard"
    to: "governance.policy.engine"
    type: "uses"
    description: "Dashboard shows policy metrics"
    
  - from: "governance.dashboard"
    to: "governance.deployment.pipeline"
    type: "uses"
    description: "Dashboard tracks deployments"
    
  # Index dependencies
  - from: "governance.index"
    to: "governance.policy.engine"
    type: "exports"
    
  - from: "governance.index"
    to: "governance.compliance.checker"
    type: "exports"
    
  - from: "governance.index"
    to: "governance.audit.manager"
    type: "exports"
    
  - from: "governance.index"
    to: "governance.deployment.pipeline"
    type: "exports"
    
  - from: "governance.index"
    to: "governance.dashboard"
    type: "exports"
    
  - from: "configuration.index"
    to: "configuration.policy.engine"
    type: "exports"
    
  - from: "configuration.index"
    to: "configuration.access.control"
    type: "exports"
    
  - from: "configuration.index"
    to: "configuration.dynamic.config"
    type: "exports"

# ============================================================================
# INTEGRATION POINTS
# ============================================================================

integration_points:
  external:
    - name: "casbin"
      type: "access_control"
      protocol: "library"
      nodes: ["configuration.access.control"]
      
    - name: "vault"
      type: "secrets_management"
      protocol: "http"
      endpoint: "https://vault:8200"
      nodes: ["configuration.dynamic.config"]
      
    - name: "compliance_frameworks"
      type: "compliance_scanning"
      frameworks: ["SOC2", "HIPAA", "GDPR", "PCI-DSS", "ISO27001", "NIST"]
      nodes: ["governance.compliance.checker"]
      
  internal:
    - name: "monitoring-observability"
      type: "observability"
      modules: ["IAuditLogger", "IMetricsCollector"]
      nodes: ["governance.audit.manager", "governance.dashboard"]
      
    - name: "data-management"
      type: "storage"
      modules: ["IStorage", "ICache"]
      nodes: ["governance.policy.engine", "configuration.access.control", "configuration.dynamic.config"]

# ============================================================================
# VALIDATION RULES
# ============================================================================

validation:
  dag_rules:
    - rule: "no_cycles"
      description: "Graph must be acyclic"
      severity: "error"
      
    - rule: "layer_ordering"
      description: "Dependencies must flow from higher to lower layers"
      severity: "error"
      
    - rule: "no_cross_layer_skip"
      description: "Cannot skip more than one layer"
      severity: "warning"
      
  dependency_rules:
    - rule: "max_dependencies"
      description: "Node should have max 5 direct dependencies"
      threshold: 5
      severity: "warning"
      
    - rule: "circular_check"
      description: "No circular dependencies allowed"
      severity: "error"
      
  security_rules:
    - rule: "audit_all_changes"
      description: "All policy and access changes must be audited"
      severity: "error"
      
    - rule: "approval_required"
      description: "Production changes require approval"
      severity: "error"

# ============================================================================
# METADATA
# ============================================================================

metadata:
  created_at: "2025-01-10T14:00:00Z"
  updated_at: "2025-01-11T10:45:00Z"
  version: "2.0.0"
  status: "active"
  total_nodes: 10
  total_edges: 18
  layers: 5
  max_depth: 5
  maintainer: "MachineNativeOps Team"
  
graph_metrics:
  complexity: "medium"
  coupling: "medium"
  cohesion: "high"
  maintainability: "excellent"
  security_score: "95/100"