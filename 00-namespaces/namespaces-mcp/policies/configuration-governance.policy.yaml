version: "2.0.0"
semantic_role: governance_policies
artifact_type: policy
semantic_root: false
module: configuration-governance

description: |
  Complete governance policies for the Configuration & Governance module.
  Defines RBAC roles, compliance requirements, security policies, and
  operational governance for policy management, access control, and deployments.

# ============================================================================
# RBAC (Role-Based Access Control)
# ============================================================================

rbac:
  roles:
    governance_admin:
      description: "Full administrative access to governance system"
      permissions:
        - "policy:*"
        - "compliance:*"
        - "access:*"
        - "config:*"
        - "deployment:*"
        - "audit:*"
      scope: "global"
      constraints:
        - "require_mfa: true"
        - "ip_whitelist: true"
      
    policy_manager:
      description: "Manage policies and rules"
      permissions:
        - "policy:create"
        - "policy:read"
        - "policy:update"
        - "policy:delete"
        - "policy:evaluate"
        - "audit:read"
      scope: "namespace"
      
    compliance_officer:
      description: "Manage compliance and audits"
      permissions:
        - "compliance:read"
        - "compliance:scan"
        - "compliance:report"
        - "audit:read"
        - "audit:export"
        - "policy:read"
      scope: "global"
      constraints:
        - "require_mfa: true"
        
    config_manager:
      description: "Manage configurations"
      permissions:
        - "config:read"
        - "config:update"
        - "config:validate"
        - "feature_flag:read"
        - "feature_flag:update"
      scope: "namespace"
      
    deployment_approver:
      description: "Approve deployment requests"
      permissions:
        - "deployment:read"
        - "deployment:approve"
        - "deployment:reject"
        - "policy:read"
      scope: "namespace"
      
    security_auditor:
      description: "View audit logs and security events"
      permissions:
        - "audit:read"
        - "audit:export"
        - "compliance:read"
        - "policy:read"
        - "access:read"
      scope: "global"
      constraints:
        - "require_mfa: true"
        - "ip_whitelist: true"

  role_bindings:
    - role: "governance_admin"
      subjects:
        - type: "group"
          name: "platform-admins"
        - type: "group"
          name: "governance-team"
          
    - role: "policy_manager"
      subjects:
        - type: "group"
          name: "policy-team"
        - type: "group"
          name: "security-team"
          
    - role: "compliance_officer"
      subjects:
        - type: "group"
          name: "compliance-team"
        - type: "user"
          name: "compliance-lead"
          
    - role: "config_manager"
      subjects:
        - type: "group"
          name: "devops-team"
        - type: "group"
          name: "platform-engineers"

# ============================================================================
# COMPLIANCE FRAMEWORKS
# ============================================================================

compliance:
  frameworks:
    SOC2:
      description: "SOC 2 Type II compliance requirements"
      requirements:
        - id: "CC6.1"
          description: "Logical and physical access controls"
          controls:
            - "RBAC enforced for all resources"
            - "MFA required for privileged access"
            - "Access reviews conducted quarterly"
            - "Principle of least privilege enforced"
          validation:
            - "Automated access control checks"
            - "Quarterly access reviews"
            
        - id: "CC6.6"
          description: "Logical access - removal"
          controls:
            - "Access revoked within 24 hours of termination"
            - "Automated deprovisioning"
            - "Access removal audited"
          validation:
            - "Automated deprovisioning checks"
            - "Monthly audit reviews"
            
        - id: "CC7.2"
          description: "System monitoring"
          controls:
            - "All policy changes logged"
            - "Compliance violations tracked"
            - "Audit trail maintained"
          validation:
            - "Continuous monitoring"
            - "Weekly log reviews"
            
    HIPAA:
      description: "HIPAA compliance for healthcare data"
      requirements:
        - id: "164.308(a)(3)"
          description: "Workforce security"
          controls:
            - "Access authorization procedures"
            - "Workforce clearance procedures"
            - "Termination procedures"
          validation:
            - "Quarterly access reviews"
            - "Annual security training"
            
        - id: "164.308(a)(4)"
          description: "Information access management"
          controls:
            - "Access control policies"
            - "Access establishment procedures"
            - "Access modification procedures"
          validation:
            - "Monthly access audits"
            - "Real-time violation detection"
            
        - id: "164.312(a)(1)"
          description: "Access control"
          controls:
            - "Unique user identification"
            - "Emergency access procedures"
            - "Automatic logoff"
            - "Encryption and decryption"
          validation:
            - "Continuous monitoring"
            - "Quarterly compliance scans"
            
    GDPR:
      description: "GDPR compliance for EU data"
      requirements:
        - id: "Article 5"
          description: "Principles relating to processing"
          controls:
            - "Lawfulness, fairness, transparency"
            - "Purpose limitation"
            - "Data minimization"
            - "Accuracy"
          validation:
            - "Data processing audits"
            - "Privacy impact assessments"
            
        - id: "Article 25"
          description: "Data protection by design and default"
          controls:
            - "Privacy by design"
            - "Default privacy settings"
            - "Minimal data processing"
          validation:
            - "Design reviews"
            - "Configuration audits"
            
        - id: "Article 32"
          description: "Security of processing"
          controls:
            - "Pseudonymization and encryption"
            - "Confidentiality and integrity"
            - "Availability and resilience"
            - "Regular testing"
          validation:
            - "Security assessments"
            - "Penetration testing"

# ============================================================================
# SECURITY POLICIES
# ============================================================================

security:
  authentication:
    methods: ["oauth2", "saml", "ldap"]
    mfa_required: true
    session_timeout: "8 hours"
    password_policy:
      min_length: 12
      require_uppercase: true
      require_lowercase: true
      require_numbers: true
      require_special: true
      expiry_days: 90
      
  authorization:
    model: "rbac"
    default_deny: true
    cache_ttl: 300  # 5 minutes
    
  encryption:
    at_rest:
      enabled: true
      algorithm: "AES-256-GCM"
      key_rotation: "90 days"
    in_transit:
      enabled: true
      protocol: "TLS 1.3"
      
  audit:
    events:
      - "policy_create"
      - "policy_update"
      - "policy_delete"
      - "access_grant"
      - "access_revoke"
      - "config_change"
      - "deployment_request"
      - "deployment_approval"
      - "compliance_scan"
    retention: "7 years"
    immutable: true

# ============================================================================
# OPERATIONAL GOVERNANCE
# ============================================================================

governance:
  change_management:
    approval_required:
      - "policy_changes"
      - "role_changes"
      - "config_changes_production"
      - "deployment_production"
    approval_levels:
      development: 0
      staging: 1
      production: 2
    review_process:
      - "peer_review"
      - "security_review"
      - "compliance_review"
    rollback_plan: "required"
    
  policy_lifecycle:
    draft_period: "7 days"
    review_period: "3 days"
    approval_required: true
    version_retention: 10
    
  compliance_management:
    scan_frequency: "daily"
    report_frequency: "monthly"
    violation_response_time:
      critical: "1 hour"
      high: "24 hours"
      medium: "7 days"
      low: "30 days"
      
  deployment_governance:
    environments:
      development:
        approval_required: false
        deployment_window: "24/7"
        rollback_automatic: true
        
      staging:
        approval_required: true
        approvers: 1
        deployment_window: "24/7"
        rollback_automatic: true
        
      production:
        approval_required: true
        approvers: 2
        deployment_window:
          days: ["mon", "tue", "wed", "thu"]
          start_time: "10:00"
          end_time: "16:00"
          timezone: "UTC"
        rollback_automatic: true
        rollback_conditions:
          - "error_rate > 5%"
          - "response_time_p99 > 2s"
          - "availability < 99.9%"

# ============================================================================
# RATE LIMITING & QUOTAS
# ============================================================================

rate_limits:
  policy_evaluation:
    per_service: "10000 evaluations/sec"
    per_user: "1000 evaluations/sec"
    burst: "2x"
    
  api_requests:
    per_user: "1000 requests/min"
    per_service: "10000 requests/min"
    burst: "1.5x"
    
  compliance_scans:
    per_namespace: "10 scans/day"
    concurrent: 5

quotas:
  policies:
    max_per_namespace: 1000
    max_rules_per_policy: 100
    
  roles:
    max_per_namespace: 500
    max_permissions_per_role: 100
    
  configurations:
    max_per_namespace: 1000
    max_size: "1 MB"
    
  deployments:
    max_concurrent: 10
    max_per_day: 100

# ============================================================================
# DATA RETENTION
# ============================================================================

data_retention:
  policies:
    active: "indefinite"
    deprecated: "1 year"
    deleted: "30 days"
    
  audit_logs:
    all_events: "7 years"
    compliance_events: "10 years"
    
  configurations:
    current: "indefinite"
    historical: "1 year"
    
  deployment_records:
    successful: "1 year"
    failed: "2 years"

# ============================================================================
# QUALITY OF SERVICE
# ============================================================================

qos:
  availability:
    target: "99.95%"
    measurement: "monthly"
    
  performance:
    policy_evaluation_p99: "< 20ms"
    access_check_p99: "< 20ms"
    config_retrieval_p99: "< 100ms"
    
  reliability:
    policy_accuracy: "> 99.9%"
    compliance_accuracy: "> 95%"

# Dependencies
dependencies:
  internal:
    - module: "protocol"
      policies: ["authentication", "authorization"]
    - module: "monitoring-observability"
      policies: ["audit", "logging"]
  external:
    - framework: "SOC2"
      version: "Type II"
    - framework: "HIPAA"
      version: "2013"
    - framework: "GDPR"
      version: "2018"

metadata:
  created_at: "2025-01-10T14:00:00Z"
  updated_at: "2025-01-11T10:15:00Z"
  version: "2.0.0"
  status: "active"
  compliance_frameworks: 3
  rbac_roles: 6
  security_controls: 20
  maintainer: "MachineNativeOps Team"