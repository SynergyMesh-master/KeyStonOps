version: "2.0.0"
semantic_role: interface_specifications
artifact_type: spec
semantic_root: false
module: configuration-governance

description: |
  Complete interface specifications for the Configuration & Governance module.
  Defines contracts for policy management, compliance checking, access control,
  dynamic configuration, and deployment governance with performance guarantees.

interfaces:
  # ============================================================================
  # LAYER 1: POLICY ENGINE INTERFACES (2 interfaces)
  # ============================================================================
  
  IPolicyEngine:
    description: "Policy evaluation and management interface"
    methods:
      createPolicy:
        description: "Create a new policy"
        parameters:
          - name: policy
            type: Policy
            required: true
        returns:
          type: string  # policy_id
        errors:
          - InvalidPolicyError
          - DuplicatePolicyError
        performance:
          p50: "< 10ms"
          p95: "< 20ms"
          p99: "< 50ms"
          
      evaluatePolicy:
        description: "Evaluate a policy against a request"
        parameters:
          - name: policy_id
            type: string
            required: true
          - name: context
            type: object
            required: true
        returns:
          type: PolicyEvaluation
        performance:
          p50: "< 5ms"
          p95: "< 10ms"
          p99: "< 20ms"
          cache_hit_rate: "> 80%"
          
      updatePolicy:
        description: "Update an existing policy"
        parameters:
          - name: policy_id
            type: string
          - name: policy
            type: Policy
        returns:
          type: void
        performance:
          p50: "< 15ms"
          
      deletePolicy:
        description: "Delete a policy"
        parameters:
          - name: policy_id
            type: string
        returns:
          type: void
        performance:
          p50: "< 10ms"
          
      listPolicies:
        description: "List all policies"
        parameters:
          - name: filters
            type: object
            required: false
        returns:
          type: Policy[]
        performance:
          p50: "< 50ms"
          p95: "< 100ms"
          
    behavioral_contracts:
      - "Policies are versioned with semantic versioning"
      - "Policy evaluation results are cached for 5 minutes"
      - "Policy changes require approval in production"
      - "Policies support rollback to previous versions"
      
  IPolicyValidator:
    description: "Policy validation interface"
    methods:
      validate:
        description: "Validate policy syntax and semantics"
        parameters:
          - name: policy
            type: Policy
            required: true
        returns:
          type: ValidationResult
        performance:
          p50: "< 10ms"
          p95: "< 20ms"
          
      testPolicy:
        description: "Test policy against sample requests"
        parameters:
          - name: policy
            type: Policy
          - name: test_cases
            type: array
        returns:
          type: TestResult[]
        performance:
          p50: "< 100ms"
          
    behavioral_contracts:
      - "Validation checks syntax, semantics, and conflicts"
      - "Test cases cover positive and negative scenarios"

  # ============================================================================
  # LAYER 2: COMPLIANCE INTERFACES (2 interfaces)
  # ============================================================================
  
  IComplianceChecker:
    description: "Compliance checking and reporting interface"
    methods:
      scanCompliance:
        description: "Scan for compliance violations"
        parameters:
          - name: framework
            type: string
            required: true
          - name: scope
            type: string
            required: false
        returns:
          type: ComplianceReport
        performance:
          p50: "< 5s"
          p95: "< 10s"
          p99: "< 30s"
          
      getComplianceStatus:
        description: "Get current compliance status"
        parameters:
          - name: framework
            type: string
            required: true
        returns:
          type: ComplianceReport
        performance:
          p50: "< 100ms"
          p95: "< 500ms"
          
      remediateViolation:
        description: "Remediate a compliance violation"
        parameters:
          - name: violation_id
            type: string
            required: true
          - name: remediation_plan
            type: object
            required: false
        returns:
          type: RemediationResult
        performance:
          p50: "< 2s"
          p95: "< 5s"
          
    behavioral_contracts:
      - "Scans run automatically on configured schedule"
      - "Critical violations trigger immediate alerts"
      - "Compliance reports retained for 7 years"
      - "Auto-remediation available for low-risk violations"
      
  IAuditManager:
    description: "Audit logging and management interface"
    methods:
      logAuditEvent:
        description: "Log an audit event"
        parameters:
          - name: event
            type: AuditEvent
            required: true
        returns:
          type: void
        performance:
          p50: "< 5ms"
          p95: "< 10ms"
          p99: "< 20ms"
          
      queryAuditLog:
        description: "Query audit logs"
        parameters:
          - name: query
            type: AuditQuery
            required: true
        returns:
          type: AuditEvent[]
        performance:
          p50: "< 200ms"
          p95: "< 1s"
          p99: "< 5s"
          
      generateAuditReport:
        description: "Generate audit report"
        parameters:
          - name: period
            type: TimePeriod
            required: true
          - name: filters
            type: object
            required: false
        returns:
          type: AuditReport
        performance:
          p50: "< 10s"
          p95: "< 30s"
          
    behavioral_contracts:
      - "Audit logs are immutable and tamper-proof"
      - "All privileged operations are audited"
      - "Audit logs retained for minimum 1 year"
      - "Audit trail includes full context"

  # ============================================================================
  # LAYER 3: ACCESS CONTROL INTERFACES (2 interfaces)
  # ============================================================================
  
  IAccessControl:
    description: "Access control and authorization interface"
    methods:
      checkAccess:
        description: "Check if access is allowed"
        parameters:
          - name: request
            type: AccessRequest
            required: true
        returns:
          type: AccessDecision
        performance:
          p50: "< 5ms"
          p95: "< 10ms"
          p99: "< 20ms"
          cache_hit_rate: "> 90%"
          
      grantAccess:
        description: "Grant access to a resource"
        parameters:
          - name: principal
            type: string
          - name: resource
            type: string
          - name: permissions
            type: string[]
        returns:
          type: void
        performance:
          p50: "< 10ms"
          
      revokeAccess:
        description: "Revoke access to a resource"
        parameters:
          - name: principal
            type: string
          - name: resource
            type: string
        returns:
          type: void
        performance:
          p50: "< 10ms"
          
      listPermissions:
        description: "List permissions for a principal"
        parameters:
          - name: principal
            type: string
            required: true
        returns:
          type: Permission[]
        performance:
          p50: "< 50ms"
          
    behavioral_contracts:
      - "Access decisions are cached for 5 minutes"
      - "Default deny policy enforced"
      - "All access checks are audited"
      - "Supports both RBAC and ABAC models"
      
  IRoleManager:
    description: "Role management interface"
    methods:
      createRole:
        description: "Create a new role"
        parameters:
          - name: role
            type: Role
            required: true
        returns:
          type: string  # role_id
        performance:
          p50: "< 10ms"
          
      assignRole:
        description: "Assign role to a principal"
        parameters:
          - name: principal
            type: string
          - name: role_id
            type: string
        returns:
          type: void
        performance:
          p50: "< 10ms"
          
      revokeRole:
        description: "Revoke role from a principal"
        parameters:
          - name: principal
            type: string
          - name: role_id
            type: string
        returns:
          type: void
        performance:
          p50: "< 10ms"
          
      getRoles:
        description: "Get roles for a principal"
        parameters:
          - name: principal
            type: string
        returns:
          type: Role[]
        performance:
          p50: "< 20ms"
          
    behavioral_contracts:
      - "Role changes take effect immediately"
      - "Role hierarchy supported"
      - "Role assignments are audited"

  # ============================================================================
  # LAYER 4: CONFIGURATION INTERFACES (2 interfaces)
  # ============================================================================
  
  IConfigurationManager:
    description: "Dynamic configuration management interface"
    methods:
      getConfiguration:
        description: "Get configuration by ID"
        parameters:
          - name: config_id
            type: string
            required: true
          - name: environment
            type: string
            required: false
        returns:
          type: Configuration
        performance:
          p50: "< 10ms"
          p95: "< 20ms"
          cache_hit_rate: "> 95%"
          
      updateConfiguration:
        description: "Update configuration"
        parameters:
          - name: config_id
            type: string
          - name: values
            type: object
          - name: change_request
            type: ConfigurationChange
        returns:
          type: Configuration
        performance:
          p50: "< 50ms"
          p95: "< 100ms"
          
      rollbackConfiguration:
        description: "Rollback to previous version"
        parameters:
          - name: config_id
            type: string
          - name: version
            type: integer
        returns:
          type: Configuration
        performance:
          p50: "< 100ms"
          
      validateConfiguration:
        description: "Validate configuration against schema"
        parameters:
          - name: config
            type: Configuration
        returns:
          type: ValidationResult
        performance:
          p50: "< 20ms"
          
    behavioral_contracts:
      - "Configuration changes require approval"
      - "Configurations are versioned"
      - "Rollback available for last 10 versions"
      - "Sensitive values are encrypted"
      
  IFeatureFlagManager:
    description: "Feature flag management interface"
    methods:
      getFlag:
        description: "Get feature flag value"
        parameters:
          - name: flag_name
            type: string
            required: true
          - name: context
            type: object
            required: false
        returns:
          type: boolean
        performance:
          p50: "< 5ms"
          p95: "< 10ms"
          cache_hit_rate: "> 99%"
          
      setFlag:
        description: "Set feature flag value"
        parameters:
          - name: flag_name
            type: string
          - name: enabled
            type: boolean
        returns:
          type: void
        performance:
          p50: "< 10ms"
          
      updateRollout:
        description: "Update rollout percentage"
        parameters:
          - name: flag_name
            type: string
          - name: percentage
            type: number
        returns:
          type: void
        performance:
          p50: "< 10ms"
          
    behavioral_contracts:
      - "Flag changes propagate within 1 second"
      - "Gradual rollout supported"
      - "Targeting rules evaluated in order"
      - "Flag evaluations are cached"

  # ============================================================================
  # LAYER 5: DEPLOYMENT GOVERNANCE INTERFACES (2 interfaces)
  # ============================================================================
  
  IDeploymentGovernance:
    description: "Deployment governance interface"
    methods:
      requestDeployment:
        description: "Request a deployment"
        parameters:
          - name: request
            type: DeploymentRequest
            required: true
        returns:
          type: string  # request_id
        performance:
          p50: "< 50ms"
          
      approveDeployment:
        description: "Approve a deployment request"
        parameters:
          - name: request_id
            type: string
          - name: approver
            type: string
          - name: comment
            type: string
        returns:
          type: void
        performance:
          p50: "< 20ms"
          
      executeDeployment:
        description: "Execute an approved deployment"
        parameters:
          - name: request_id
            type: string
        returns:
          type: DeploymentResult
        performance:
          p50: "< 5min"
          p95: "< 10min"
          
      rollbackDeployment:
        description: "Rollback a deployment"
        parameters:
          - name: deployment_id
            type: string
        returns:
          type: DeploymentResult
        performance:
          p50: "< 2min"
          
    behavioral_contracts:
      - "Production deployments require approval"
      - "Deployments respect deployment windows"
      - "Automatic rollback on failure"
      - "All deployments are audited"
      
  IGovernanceDashboard:
    description: "Governance dashboard interface"
    methods:
      getMetrics:
        description: "Get governance metrics"
        parameters:
          - name: metric_type
            type: string
            required: true
          - name: time_range
            type: TimeRange
            required: false
        returns:
          type: MetricData
        performance:
          p50: "< 100ms"
          p95: "< 500ms"
          
      getViolations:
        description: "Get policy/compliance violations"
        parameters:
          - name: filters
            type: object
            required: false
        returns:
          type: Violation[]
        performance:
          p50: "< 200ms"
          
      generateReport:
        description: "Generate governance report"
        parameters:
          - name: report_type
            type: string
          - name: period
            type: TimePeriod
        returns:
          type: Report
        performance:
          p50: "< 10s"
          
    behavioral_contracts:
      - "Dashboard updates in real-time"
      - "Metrics aggregated every 1 minute"
      - "Reports available in multiple formats"

# Performance contracts summary
performance_summary:
  policy_evaluation:
    latency_p50: "< 5ms"
    latency_p99: "< 20ms"
    cache_hit_rate: "> 80%"
    
  compliance_scanning:
    latency_p50: "< 5s"
    latency_p99: "< 30s"
    accuracy: "> 95%"
    
  access_control:
    latency_p50: "< 5ms"
    latency_p99: "< 20ms"
    cache_hit_rate: "> 90%"
    
  configuration:
    latency_p50: "< 10ms"
    latency_p99: "< 100ms"
    cache_hit_rate: "> 95%"
    
  deployment:
    approval_time: "< 1 hour"
    execution_time: "< 10 minutes"
    rollback_time: "< 2 minutes"

# Dependencies
dependencies:
  internal:
    - module: "protocol"
      interfaces: ["IRequest", "IResponse"]
    - module: "monitoring-observability"
      interfaces: ["IAuditLogger", "IMetricsCollector"]
  external:
    - library: "casbin"
      version: "^5.26.0"
    - library: "ajv"
      version: "^8.12.0"

metadata:
  created_at: "2025-01-10T14:00:00Z"
  updated_at: "2025-01-11T10:00:00Z"
  version: "2.0.0"
  status: "active"
  total_interfaces: 10
  total_methods: 35
  source_files: 10
  maintainer: "MachineNativeOps Team"